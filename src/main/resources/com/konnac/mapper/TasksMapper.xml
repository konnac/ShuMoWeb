<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.konnac.mapper.TasksMapper">

    <sql id="commonSelect">
        select id, project_id, title, description, assignee_id, estimated_hours,
               actual_hours, deadline, status, created_time, update_time
        from tasks
    </sql>
<!--新增任务-->
    <insert id="addTask" useGeneratedKeys="true" keyProperty="id">
        insert into tasks(project_id, title, description, assignee_id, estimated_hours,
                          actual_hours, deadline, status, created_time, update_time)
        VALUES (#{projectId}, #{title}, #{description}, #{assigneeId}, #{estimatedHours},
                #{actualHours}, #{deadline}, #{status}, #{createdTime}, #{updateTime})
    </insert>
<!--批量删除-->
    <delete id="deleteTask">
        delete from tasks where id in
        <foreach item="id" collection="ids" separator="," open="(" close=")">
            #{id}
        </foreach>
    </delete>
<!--修改任务信息-->
    <update id="updateTask">
        UPDATE tasks
        <set>
            <if test="projectId != null">
            project_id = #{projectId},
             </if>
            <if test="title != null">
                title = #{title},
            </if>
            <if test="description != null">
                description = #{description},
            </if>
            <if test="assigneeId != null">
                assignee_id = #{assigneeId},
            </if>
            <if test="estimatedHours != null">
                estimated_hours = #{estimatedHours},
            </if>
            <if test="actualHours != null">
                actual_hours = #{actualHours},
            </if>
            <if test="deadline != null">
                deadline = #{deadline},
            </if>
            <if test="status != null">
                status = #{status},
            </if>
            update_time = #{updateTime}
        </set>
        WHERE id = #{id}
    </update>

</mapper>